---
title: "Projet S9"
author: "Adrien Faissat, Guillaume Schmit, Omar Himych, Morgane Roy"
date: "03/03/2022"
output:
  html_document:
    toc: yes
    toc_depth: 4
    number_sections: yes
---

```{r setup, include=FALSE}
library(readr)
library(ggplot2)
library(lubridate)
library(dplyr)
library(ReIns)
library(extRemes)
library(evd)

# Setup of options for the rmarkdown document
knitr::opts_chunk$set(echo = TRUE, # By default, codes are shown
                      warning = FALSE, # Warnings are not printed
                      message = FALSE, # Messages are not printed
                      out.width = "90%",
                      fig.align = 'center') # Codes results are cached into a 
# dedicated _cache directory which should be ignored by git (and emptied regularly)

## https://bookdown.org/yihui/rmarkdown/markdown-syntax.html pour des tips

```

# Introdution

## Int√©r√™t g√©n√©ral des indices
## Types d'indices

# Indices √©tudi√©s  {.tabset}


## Fosberg Fire Weather Index (FFWI)

## FWI Canadien

## Angstrom Index

## MacArthur Grassland Mark 5 Index


# Discussion comparative des formules

## Variables d'entr√©e

## Statique vs Dynamique

## √âchelles temporelles

# Impl√©mentation des calculs {.tabset}

Nous commen√ßons par exploiter les donn√©es recueillies par la station de Salon-de-Provence.
Nous avons √©galement utilis√© la base de donn√©es en ligne Prom√©th√©e afin de recueillir la totalit√© des incendies ayant eu lieu sur la p√©riode √©tudi√©e dans le d√©partement. Cela nous permettra de confronter les indices avec la r√©alit√©.   

```{r data_loading, warning=FALSE, message=FALSE, cache=TRUE}
RR_2000_2021 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/RR 2000-2021.csv", 
                           delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(RR_2000_2021)

RR_81_99 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/RR 81-99.csv", 
                       delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(RR_81_99)

# Le vent

VT_81_99 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/VT 81-99.csv", 
                       delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(VT_81_99)


VT_2000_2021 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/VT 2000-2021.csv", 
                           delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(VT_2000_2021)

# La temp√©rature 

T_81_99 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/T 81-99.csv", 
                      delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(T_81_99)

T_2000_2021 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/T 2000-2021.csv", 
                          delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(T_2000_2021)

# l'humidit√© 

U_81_99 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/U 81-99.csv", 
                      delim = ";", escape_double = FALSE, trim_ws = TRUE)
#View(U_81_99)


U_2000_2021 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/U 2000-2021.csv", 
                          delim = ";", escape_double = FALSE, trim_ws = TRUE)

```

## Fosberg Fire Weather Index (FFWI)

### ConcatÈnation des donnÈes 

```{r FFwi}

U_complet<- rbind(U_81_99,U_2000_2021)
 

VT_complet<- rbind(VT_81_99,VT_2000_2021)

T_complet<- rbind(T_81_99,T_2000_2021)

RR_complet<- rbind(RR_81_99,RR_2000_2021)

length(RR_complet$RR)
length(T_complet$T)

```

###  Gestion des valeurs manquants 

```{r FFWI}

263232-length(na.omit(T_complet$T))

263232-length(na.omit(VT_complet$VT))

263232-length(na.omit(U_complet$U))

263232-length(na.omit(RR_complet$RR))

```

```{r FFWI}

mean(na.omit(RR_complet$RR))

mean(na.omit(T_complet$T))

mean(na.omit(VT_complet$VT))

mean(na.omit(U_complet$U))


```


```{r FFWI}

RR_complet[is.na(RR_complet)]<-0.06693427
T_complet[is.na(T_complet)]<-14.59049
VT_complet[is.na(VT_complet)]<-13.60234
U_complet[is.na(U_complet)]<-67.76571

length(na.omit(RR_complet$RR))
length(na.omit(T_complet$T))
length(na.omit(VT_complet$VT)) 
length(na.omit(U_complet$U))

```


### Calcul de FFWI :

#### EMC :

```{r FFWI}

EMC <- function(H,t) {
  
  
  if (H < 10 )  {
    resu <- 0.03229 + 0.281073*H - 0.000578*H*t
    
  } 
  
  else { 
    if (H >= 50) {
    resu <- 21.0606 + 0.005565*H*H - 0.00035*H*t - 0.483199*H
    
    } 
  
   else {
    resu <- 2.22749 + 0.160107*H - 0.01478*t
  } }
  
  return(resu)
}

```

#### Nu :

```{r FFWI}

nu <- function(H,t){
  
  resu2=1 -2*((EMC(H,t))/30) + 1.5*((EMC(H,t))/30)*((EMC(H,t))/30) + 0.5*((EMC(H,t))/30)*((EMC(H,t))/30)*((EMC(H,t))/30)
  
  return(resu2)
}


```

#### FFWI :

```{r FFWI}

FFWI<- function(H,t,V){return((nu(H,t)*sqrt(1+V*V))/0.3002)}

FFWI(U_complet$U[length(U_complet)],T_complet$T[length(T_complet)],VT_complet$VT[length(VT_complet)])
```



```{r FFWI}
FFwi_values<-cbind(T_complet)
names(FFwi_values)[names(FFwi_values) == "T"] <- "FFwi"
 
FFwi_values$FFwi[1]<-0
FFwi_values$FFwi[2]<-0



for (i in 1:length(FFwi_values$FFwi))  {
    
    FFwi_values$FFwi[i]<- FFWI(U_complet$U[i],T_complet$T[i],VT_complet$VT[i])
 
  }


```


## FWI Canadien

## Angstrom Index

```{r angstrom_implementation, cache=TRUE}
T_13h <- rbind(T_81_99[T_81_99$HEURE == 13,],T_2000_2021[T_2000_2021$HEURE == 13,])
U_13h <- rbind(U_81_99[U_81_99$HEURE == 13,],U_2000_2021[U_2000_2021$HEURE == 13,])
  
Angstrom_Index <- data.frame(matrix(ncol=7,nrow=nrow(T_13h)))
colnames(Angstrom_Index) <- c("DATE", "AN", "MOIS", "JOUR","ANGSTROM_INDEX", "U", "T")

for(i in 1:nrow(Angstrom_Index))
{
  ligne_humidite <- U_13h[i,]
  ligne_temperature <- T_13h[T_13h$AN == ligne_humidite$AN & T_13h$MOIS == ligne_humidite$MOIS & T_13h$JOUR == ligne_humidite$JOUR,]
  
  index <- (ligne_humidite$U / 20) + (27 - ligne_temperature$T)/10
  
  Angstrom_Index[i,] <- c(as.Date(gsub(" ", "", paste(ligne_humidite$JOUR,"/",ligne_humidite$MOIS,"/",ligne_humidite$AN)),format="%d/%m/%Y", origin="1970-01-01"),ligne_humidite$AN, ligne_humidite$MOIS, ligne_humidite$JOUR, index, ligne_humidite$U, ligne_temperature$T)

}


nb_iteration = nrow(Angstrom_Index)
Index_Summer <- data.frame(DATE=numeric(), AN=numeric(), MOIS=numeric(), JOUR=numeric(),ANGSTROM_INDEX=numeric(), U = numeric(), T=numeric(), stringsAsFactors=FALSE)

for (i in 1:nb_iteration){
  month <- month(as.Date(Angstrom_Index[i,]$DATE, origin="1970-01-01"))
  if(month == 6 || month == 7 || month == 8){
      Index_Summer[nrow(Index_Summer)+1,] <- Angstrom_Index[i,]
  }
}
  
```

## MacArthur Grassland Mark 5 Index




# Analyse des s√©ries d'indice {.tabset}

Nous mettons ici une fonction qui nous aidera pour les corr√©lations extr√™males entre s√©ries :

````{r}
extremal_correlation_input_output <- function(input,output, quant){
  u1 = quantile(output, quant, na.rm = TRUE)
  u2 = quantile(input, quant, na.rm = TRUE)
  xi.est.quantile = sum(output > u1 & input > u2)/sum(output > u1)
  
  xi.est.quantile
}

````


## Fosberg Fire Weather Index (FFWI)

### Analyse g√©n√©rale :


```{r FFWI}
summary(FFwi_values)

year2plot = 2019
plot(FFwi_values$FFwi[FFwi_values$AN == year2plot], type = "h", xlab='Jours', ylab='FFWI index', main='Evolution temporelle de FFWI entre 1981 ‡ 2021' )


hist(FFwi_values$FFwi, freq=F, col='green', breaks=35, xlab='les valeurs de FFWI', main='La distribution de FFWI')
lines(density(FFwi_values$FFwi), col='red',lwd=3)

```


```{r  FFWI}

acf(FFwi_values$FFwi, na.action = na.pass, lag.max = 18, main="Auto-corr√©lation temporelle de l'indice")

acf(FFwi_values$FFwi, na.action = na.pass, lag.max = 100, main="Auto-corr√©lation temporelle de l'indice")


```

### FFWI_13 et les incendies :


```{r}

##  rÈorganise FFWI 13h rÈorganiser

T_13h <- T_complet[T_complet$HEURE == 13,]
U_13h <- U_complet[U_complet$HEURE == 13,]

FFWI_Index_13 <<- data.frame(matrix(ncol=2,nrow=10968))

colnames(FFWI_Index_13) <- c("DATE", "FFWI_INDEX")

#View(FFWI_Index_13)

for(i in 1:10968){
  
  ligne_humidite <- U_13h[i,]

  FFWI_Index_13[i,] <- c(as.Date(gsub(" ", "", paste(ligne_humidite$JOUR,"/",ligne_humidite$MOIS,"/",ligne_humidite$AN)),format="%d/%m/%Y", origin="1970-01-01"), FFwi_values$FFwi[i])
  
}
```

```{r}



T_date<<- data.frame(matrix(ncol=2,nrow=8760))

colnames(T_date) <- c("DATE", "T")


for(i in 254472:263232){
  
  ligne_humidite <-T_complet[i,]

  T_date[i,] <- c(as.Date(gsub(" ", "", paste(ligne_humidite$JOUR,"/",ligne_humidite$MOIS,"/",ligne_humidite$AN)),format="%d/%m/%Y", origin="1970-01-01"), T_complet$T[i])
  
}
```


```{r}


U_date<<- data.frame(matrix(ncol=2,nrow=8760))

colnames(U_date) <- c("DATE", "U")


for(i in 254472:263232){
  
  ligne_humidite <-U_complet[i,]

  U_date[i,] <- c(as.Date(gsub(" ", "", paste(ligne_humidite$JOUR,"/",ligne_humidite$MOIS,"/",ligne_humidite$AN)),format="%d/%m/%Y", origin="1970-01-01"), U_complet$T[i])
  
}
```


```{r}



VT_date<<- data.frame(matrix(ncol=2,nrow=8760))

colnames(VT_date) <- c("DATE", "VT")


for(i in 254472:263232){
  
  ligne_humidite <- VT_complet[i,]

  VT_date[i,] <- c(as.Date(gsub(" ", "", paste(ligne_humidite$JOUR,"/",ligne_humidite$MOIS,"/",ligne_humidite$AN)),format="%d/%m/%Y", origin="1970-01-01"), VT_complet$T[i])
  
}
```




```{r}
########


Incendie_81_2021 <- read_delim("C:/Users/rachid/Desktop/Projet_Option/liste_incendies_91_2021.csv")



seuil_incendie <- 10000 #m2 seuil pour les incendies

date_debut <- as.Date("01/01/2000","%d/%m/%Y")
date_fin <- as.Date("22/12/2020","%d/%m/%Y")

nb_iteration = nrow(FFWI_Index_13)
Index_Summer <<- data.frame(DATE=numeric(), FFWI_Index_13=numeric(), stringsAsFactors=FALSE)

for (i in 1:nb_iteration){
  
  month <- month(as.Date(FFWI_Index_13[i,]$DATE, origin="1970-01-01"))
  if(month == 6 || month == 7 || month == 8){
    Index_Summer[nrow(Index_Summer)+1,] <- FFWI_Index_13[i,]
  }
  
}


########

Incendies_filtered <- Incendie_81_2021[Incendie_81_2021$`Surface parcourue (m2)` >= seuil_incendie,]


graph_ffwi <- FFWI_Index_13 %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))

graph_T <- T_date %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))

graph_U <- U_date %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))

graph_VT <- VT_date %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))

graph_summer_FFwi_index <- Index_Summer %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))

length(graph_ffwi$FFWI_INDEX)
length(FFWI_Index_13$FFWI_INDEX)

```



```{r}

### Plotting all dates within chosen range ###

ggplot(data = graph_ffwi,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y =FFWI_INDEX, color = FFWI_INDEX, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="red", high="green") +
  labs(x = "Date", y = "FFWI Index") +
  geom_point(data = graph_ffwi %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

### Plotting all summer dates within chosen range ###

ggplot(data = graph_summer_FFwi_index,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y = FFWI_Index_13, color = FFWI_Index_13, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="red", high="green") +
  labs(x = "Date", y = "FFWI Index") +
  geom_point(data = graph_summer_FFwi_index %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

```



### Tail index

```{r}

moment_data <- na.omit(FFwi_values)
moment_data$FFwi <- moment_data$FFwi *-1
min_moment <- min(moment_data$FFwi)
moment_data$FFwi <- moment_data$FFwi - min_moment +1
moment_data <- moment_data[moment_data$FFwi > 0,]

MFFWI <- Moment(moment_data$FFwi, logk = FALSE, plot = TRUE, main = "Estimation de moment pour FFWI")

plot(MFFWI$k[MFFWI$k %in% 25:500], MFFWI$gamma[MFFWI$k %in% 25:500], main="", xlab="Nombre des evenements extremes ", ylab="Tail index")

```

### Auto-corr√©lation extr√™male


```{r}

###

prob = .95 # la probablitÈ correspondante au seuil u
tmp1 = atdf(as.ts(FFwi_values$FFwi), u = prob, plot = FALSE, lag.max = 40, type = "rho")
par(mar = c(5, 5, .5, .5), cex.lab = 2, cex.axis = 2, lwd = 2, cex = 1)
plot(tmp1, main = "", xlab = "h", ylab = expression(chi(u,h)))
lines(c(0, 100), rep(1-prob,2), lwd = 2, lty = 2, col = "red")

```

```{r}

###

moment_summer <- na.omit(Index_Summer)

prob = .95 # probability for quantile to be used as threshold
tmp2 = atdf(as.ts(moment_summe$FFWI_INDEX), u = prob, plot = FALSE, lag.max = 21, type = "rho")
par(mar = c(5, 5, .5, .5), cex.lab = 2, cex.axis = 2, lwd = 2, cex = 1)
plot(tmp2, main = "", xlab = "h", ylab = expression(chi(u,h)))
lines(c(0, 100), rep(1-prob,2), lwd = 2, lty = 2, col = "red")

```


### Corr√©lation extr√™male entre les s√©ries
Ici comparaison nentre les indices  Angstrom et FFWI





## FWI Canadien

### Tail index 
### Auto-corr√©lation extr√™male
### Corr√©lation extr√™male entre les s√©ries

## Angstrom Index

### Analyse g√©n√©rale

```` {r angstrom_general_analysis, warning=FALSE}

acf(Angstrom_Index$ANGSTROM_INDEX, na.action = na.pass, lag.max = 21, main="Auto-corr√©lation temporelle de l'indice")

acf(Index_Summer$ANGSTROM_INDEX, na.action = na.pass, lag.max = 21, main ="Auto-corr√©lation temporelle de l'indice pris sur les p√©riodes estivales")

````

On constate que l'auto-corr√©lation est plus √©lev√©e quand on consid√®re les p√©riodes non-estivales, ce qui n'est pas particuli√®rement √©tonnant : il para√Æt coh√©rent que les p√©riodes moins chaudes et moins s√®ches soient moins propices √† des valeurs extr√™mes de risque d'incendie, et donc une certaine corr√©lation entre les jours "non-incendie".

````{r}
seuil_incendie <- 10000 #m2 seuil pour les incendies

date_debut <- as.Date("01/06/2000","%d/%m/%Y")
date_fin <- as.Date("22/12/2020","%d/%m/%Y")

########

Incendies_filtered <- Incendie_81_2021[Incendie_81_2021$`Surface parcourue (m2)` >= seuil_incendie,]


graph_angstrom_index <- Angstrom_Index %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))

graph_summer_angstrom_index <- Index_Summer %>% filter(between(as.Date(DATE,origin="1970-01-01"), date_debut,date_fin))


### Plotting all dates within chosen range ###

ggplot(data = graph_angstrom_index,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y = ANGSTROM_INDEX, color = ANGSTROM_INDEX, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="red", high="green") +
  labs(x = "Date", y = "Angstrom Index") +
  geom_point(data = graph_angstrom_index %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

### Plotting all summer dates within chosen range ###

ggplot(data = graph_summer_angstrom_index,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y = ANGSTROM_INDEX, color = ANGSTROM_INDEX, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="red", high="green") +
  labs(x = "Date", y = "Angstrom Index") +
  geom_point(data = graph_summer_angstrom_index %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")


````

On constate que la majorit√© des gros incendies (> 10000 m¬≤) ont bien lieu lors des p√©riodes o√π le risque pr√©vu par l'indice Angstrom est est √©lev√© (donc valeur de l'indice faible).

### Tail index 

```` {r}

moment_data <- na.omit(Angstrom_Index)
moment_data$ANGSTROM_INDEX <- moment_data$ANGSTROM_INDEX *-1
min_moment <- min(moment_data$ANGSTROM_INDEX)
moment_data$ANGSTROM_INDEX <- moment_data$ANGSTROM_INDEX - min_moment +1
moment_data <- moment_data[moment_data$ANGSTROM_INDEX > 0,]
M <- Moment(moment_data$ANGSTROM_INDEX, logk = FALSE, plot = TRUE, main = "Moment estimate of the Angstrom Index")

plot(M$k[M$k %in% 25:500], M$gamma[M$k %in% 25:500], main="", xlab="Number of extreme events", ylab="Tail index")

````

### Auto-corr√©lation extr√™male

````{r}


###

moment_summer <- na.omit(Index_Summer)
prob = .95 # probability for quantile to be used as threshold
tmp = atdf(as.ts(moment_summer$ANGSTROM_INDEX), u = prob, plot = FALSE, lag.max = 21, type = "rho")
par(mar = c(5, 5, .5, .5), cex.lab = 2, cex.axis = 2, lwd = 2, cex = 1)
plot(tmp, main = "", xlab = "h", ylab = expression(chi(u,h)))
lines(c(0, 100), rep(1-prob,2), lwd = 2, lty = 2, col = "red")

````

### Corr√©lation extr√™male entre les s√©ries

#### Estimation empirque de  "tail correlation" xi :

````{r}
chiplot(cbind(FFWI_Index_13$FFWI_INDEX,Angstrom_Index$ANGSTROM_INDEX ), qlim = c(0.8, .9995), xlim = c(0.8, .9995), which = 1)

````

## MacArthur Grassland Mark 5 Index

### Tail index 
### Auto-corr√©lation extr√™male
### Corr√©lation extr√™male entre les s√©ries




# Analyse par rapport aux donn√©es d'entr√©e {.tabset}

## Fosberg Fire Weather Index (FFWI)


```{r FFWI_input_temperature}
### plotting temperatures within chosen range ###

date_debut <- as.Date("01/06/2020","%d/%m/%Y")
date_fin <- as.Date("31/12/2021","%d/%m/%Y")

ggplot(data = graph_T,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y =T, color =T, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="green", high="red") +
  labs(x = "Date", y = "Temperatures") +
  geom_point(data = graph_ffwi %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

quant = 0.95

FFWI_Index_omit <- na.omit(FFwi_values)

FFWI_Index_omit_reverse <- FFWI_Index_omit
FFWI_Index_omit_reverse$FFwi <- FFWI_Index_omit_reverse$FFwi *-1

min_FFWI_Index_omit_reverse <- min(FFWI_Index_omit_reverse$FFwi)

FFWI_Index_omit_reverse$FFwi <- FFWI_Index_omit_reverse$FFwi - min_FFWI_Index_omit_reverse +1

extremal_correlation_input_output(FFWI_Index_omit_reverse$T, FFWI_Index_omit_reverse$FFwi,quant)

```


````{r FFWI_input_HumiditÈ}

### plotting humidty within chosen range ###

ggplot(data = graph_U,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y = U, color = U, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="red", high="green") +
  labs(x = "Date", y = "HumiditÈ") +
  geom_point(data = graph_ffwi %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

extremal_correlation_input_output(U_complet$U,FFwi_values$FFwi,quant)

````


## FWI Canadien

## Angstrom Index

Nous allons commencer par analyser la sensibilit√© de cet indice par rapport √† la temp√©rature.
Afin d'avoir des extr√™mes qui correspondent, nous inversons les valeurs de l'indice (√©tant donn√© que de base, une valeur faible indique un potentiel plus √©lev√© d'incendie).

```` {r angstrom_input_temperature, warning=FALSE}
### plotting temperatures within chosen range ###

ggplot(data = graph_angstrom_index,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y = T, color = T, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="green", high="red") +
  labs(x = "Date", y = "Temperatures") +
  geom_point(data = graph_angstrom_index %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

quant = 0.95

Angstrom_Index_omit <- na.omit(Angstrom_Index)

Angstrom_Index_omit_reverse <- Angstrom_Index_omit
Angstrom_Index_omit_reverse$ANGSTROM_INDEX <- Angstrom_Index_omit_reverse$ANGSTROM_INDEX *-1
min_Angstrom_Index_omit_reverse <- min(Angstrom_Index_omit_reverse$ANGSTROM_INDEX)
Angstrom_Index_omit_reverse$ANGSTROM_INDEX <- Angstrom_Index_omit_reverse$ANGSTROM_INDEX - min_Angstrom_Index_omit_reverse +1

extremal_correlation_input_output(Angstrom_Index_omit_reverse$T, Angstrom_Index_omit_reverse$ANGSTROM_INDEX,quant)

````
Pour √©tudier la sensibilit√© vis-√†-vis de l'humidit√©, nous n'utilisons pas les valeurs invers√©es de l'indice car nous voulons v√©rifier une corr√©lation invers√©e : lorsque l'humidit√© est tr√®s √©lev√©e, il est coh√©rent d'attendre un indice indiquant un risque moins √©lev√© d'incendies, et donc une valeur √©lev√©e.

````{r angstrom_input_humidity, warning=FALSE}
### plotting humidty within chosen range ###

ggplot(data = graph_angstrom_index,
       mapping = aes(x = as.Date(DATE, origin="1970-01-01"), y = U, color = U, xmin = date_debut,xmax=date_fin)) +
  geom_point() +
  scale_color_gradient(guide="none", low="red", high="green") +
  labs(x = "Date", y = "Temperatures") +
  geom_point(data = graph_angstrom_index %>% filter(as.Date(DATE, origin="1970-01-01") %in% as.Date.character(Incendies_filtered$Alerte,format="%d/%m/%Y %H:%M", origin="1970-01-01")),
             pch=16, size=2, colour="black")

extremal_correlation_input_output(Angstrom_Index_omit$U,Angstrom_Index_omit$ANGSTROM_INDEX,quant)

````
Nous trouvons une corr√©lation invers√©e plus √©lev√©e que la corr√©lation avec la temp√©rature, ce qui permet de conclure que l'indice Angstrom est l√©g√®rement plus sensible √† la s√©cheresse qu'√† la temp√©rature.

## MacArthur Grassland Mark 5 Index
# Conclusion